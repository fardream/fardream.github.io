---
layout: post
title:  "Portfolio Optimization Part 3: Transaction Cost"
date:   2021-04-27 20:51:00 -0400
categories: portfolio optimization
---

## Transaction Cost

There are two components of transaction costs:

1. The cost that is explicitly paid, such as commission to the broker.

2. The cost that is associated with the price movement from trading.

There are many literatures on the price impact of trading, but for this discussion, only how it can be used in optimization is concerned.

## Single Period Transaction Cost Model

Generally, transaction cost model takes into consideration of the volatility of the stock, the trading horizon, the trading volume, and the usual bid ask spread. That is:

- Higher the volitility, higher the transaction cost.
- Higher the volume, lower the transaction cost.
- Longer the trading horizon, lower the transaction cost.
- Higher the usual bid ask spread, higher the transaction cost.

Of course, higher the transaction size, higher the cost.

One example given is in *Active Portfolio Management* by *Richard Grinold* and *Ronald N. Kahn* for transaction cost per dollar:

$$\begin{align}
\text{Cost} = \text{commission} + \left(\frac{\text{bid/ask spread}}{\text{price}}\right) + c_{\text{tc}}\sqrt{\frac{V_{\text{trade}}}{\bar{V}_{\text{daily}}}}
\end{align}$$

Where

$$\begin{align}
c_{\text{tc}} \sim O\left(\sigma / \sqrt{250}\right)
\end{align}$$

Let simplify the notation, let

- $$\delta$$ be cost,
- $$f$$ be commission,
- $$s$$ be bid/ask spread over price,
- $$t$$ be the trade size,
- $$V$$ be the daily volume,
- $$d$$ be the number of days to trade - predetermined.

Futhermore, let's generalize formulation

$$\begin{align}
\delta =
f + c_1 s + c_2 \sigma \left(\frac{t}{Vd}\right)^p
\end{align}$$

where $$f$$, $$c_1$$, $$c_2$$ are coefficents that can be fitted from data, and $$p$$ is the order that we can choose - here we only choose either $$3/2$$ for five thirds, $$1/2$$ for three halves, or $$1$$ for quadratic t cost.

Note the actual cost in optimization is the total cost is the cost multiplied by dollar traded

$$\begin{align}
t\delta = t\left(f + c_1 s + c_2 \sigma \left(\frac{t}{Vd}\right)^p\right)
\end{align}$$

Also note the $$t$$ should be the absolute value of the dollar amount traded.

## Several Notes

1. Transaction cost is highly dependent on how the trades are actually done. For example, a human trader may have different cost from an algo, and a VWAP algo may have very different cost than an implementation shortfall algo. Different broker algos may also have different trading cost even for the same category of algos.
1. The data for fitting transaction cost model is extremely noisy - natural price movement during a typical trading day maybe several times over the typical trading cost.
1. Quality of data is extremely important. Besides market data, there may be some places that introduce unintended errors into the model, such as arrival price (use the price that which the investment decision is made, or use the time that the button price by a trader that starts the algo).
1. The alpha imbedded in the investment idea may interfere with the transaction cost. It is difficult to tell transaction cost from short term alpha.
1. The investment style may have impact on the transaction cost.
1. It is unnecessary for the transaction cost model for trading analytics and optimization to be the same one.

## Cost of liquidation

Another cost that may need to be taken into consideration is the cost of liquidating the whole portfolio. It's basically saying "don't get a position too big". Note that the market conditions (such as volume, spread) may be dramatically different when market wide tumult causes those liquidations. This can be model either by adding the t cost of the liquidation to the optimization, which is equivalent to a sizing penalty, or a double sided t cost can be used.

## Construct Transaction Cost Model

Besides academic papers and fitting your own models, there are also vendors that sell transaction cost models and trading analytics (my ex-employer, ITG, which was acquired by Virtu Financial, sells those products).
